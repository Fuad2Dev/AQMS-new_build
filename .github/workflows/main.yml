name: Build and Deploy
on:
    push:
        branches:
            -   main
jobs:
    build:
        name: 👨‍🏭 build
        runs-on: ubuntu-latest
        steps:
            - name: Checkout Repository
              uses: actions/checkout@master
            - name: Setup Enviroment
              uses: shivammathur/setup-php@v2
              with:
                php-version: '8.0'
            - name: Install dependencies
              run: composer install --no-dev --no-progress --no-suggest --optimize-autoloader
            - name: Install Node.js
              uses: actions/setup-node@v2
              with:
                node-version: '18'
            - name: Install Node.js dependencies
              run: npm ci
            - name: Compile assets
              run: npm run build
            - name: 🚀 Deploy
              uses: SamKirkland/FTP-Deploy-Action@v4.3.4
              with:
                server: ftp.atutracer.net
                username: ${{ secrets.FTP_HOSTNAME }}
                password: ${{ secrets.FTP_PASSWORD }}
